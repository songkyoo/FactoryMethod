# Factory Method

타입이나 생성자에 어트리뷰트를 선언하여 생성자에 대한 정적 팩토리 메서드를 자동으로 생성하는 C# 소스 제네레이터입니다.

## 사용법

### 타입에 `AutoFactory` 어트리뷰트 선언하기

타입에 `AutoFactory` 어트리뷰트를 선언하면 `Of` 이름을 가진 팩토리 메서드를 생성합니다. 생성 대상의 조건은

1. 매개 변수가 존재하고
2. 접근 제한자가 `public`, `internal`

인 경우입니다.

```csharp
using Macaron.FactoryMethod;

[AutoFactory]
public partial class Foo
{
    public Foo() { }

    public Foo(int bar) { }

    public Foo(int bar, string baz) { }

    internal Foo(int bar, int baz) { }

    protected Foo(int bar, string baz, int qux) { }
}
```

위 코드는 다음과 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial class Foo
{
    public static Foo Of(int bar) => new(bar);

    public static Foo Of(int bar, string baz) => new(bar, baz);

    internal static Foo Of(int bar, int baz) => new(bar, baz);
}
```

만약 이미 동일한 시그니처의 메서드가 존재한다면 해당 메서드는 생성하지 않습니다. 이 경우 반환 값의 타입은 고려하지 않습니다.

```csharp
using Macaron.FactoryMethod;

public class Bar
{
    public Bar(int bar, string qux)
    {
    }
}

[AutoFactory]
public partial class Foo
{
    public static Bar Of(int bar, string qux) => new Bar(bar, qux);

    public Foo(int bar) { }

    public Foo(int bar, string baz) { }
}
```

위 코드는 아래와 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial class Foo
{
    public static Foo Of(int bar) => new(bar);
}
```

대상이 되는 생성자의 매개변수가 파스칼 케이스인 경우 카멜 케이스로 변경됩니다.

```csharp
using Macaron.FactoryMethod;

[AutoFactory]
public partial record Foo(int Bar, string Baz);
```

위와 같은 코드는 다음과 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial record Foo
{
    public static Foo Of(int bar, string baz) => new(bar, baz);
}
```

### 특정 생성자를 대상에서 제외하기

`IgnoreAutoFactory` 어트리뷰트를 생성자에 선언하면 팩토리 메서드 생성 대상에서 제외됩니다.

```csharp
using Macaron.FactoryMethod;

[AutoFactory]
public partial class Foo
{
    public Foo(int bar) { }

    [IgnoreAutoFactory]
    public Foo(int bar, string baz) { }
}
```

위 코드는 다음과 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial class Foo
{
    public static Foo Of(int bar) => new(bar);
}
```

### 생성자에 `AutoFactory` 어트리뷰트 선언하기

타입의 모든 생성자가 아니라 특정 생성자만 `AutoFactory`를 사용하여 팩토리 메서드를 생성할 수 있습니다. 이 경우 생성자의 접근 제한자가 `private`인 경우에도 팩토리 메서드를 생성합니다. 생성되는 팩토리 메서드의 접근 제한자는 `public`입니다.

```csharp
using Macaron.FactoryMethod;

public partial class Foo
{
    [AutoFactory]
    public Foo(int bar) { }

    [AutoFactory]
    private Foo(int bar, string baz) { }
}
```

위 코드는 다음과 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial class Foo
{
    public static Foo Of(int bar) => new(bar);

    public static Foo Of(int bar, string baz) => new(bar, baz);
}
```

타입과 생성자에 동시에 선언할 수 있습니다.

```csharp
using Macaron.FactoryMethod;

[AutoFactory]
public partial class Foo
{
    public Foo(int bar) { }

    [AutoFactory]
    private Foo(int bar, string baz) { }
}
```

위 코드는 다음과 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial class Foo
{
    public static Foo Of(int bar) => new(bar);

    public static Foo Of(int bar, string baz) => new(bar, baz);
}
```

### 생성되는 정적 메서드 이름 변경하기

`AutoFactory` 어트리뷰트의 `methodName` 값을 사용하여 생성되는 팩토리 메서드 이름을 변경할 수 있습니다.

```csharp
using Macaron.FactoryMethod;

[AutoFactory(methodName: "Create")]
public partial class Foo
{
    public Foo(int bar) { }
}
```

위 코드는 아래와 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial class Foo
{
    public static Foo Create(int bar) => new(bar);
}
```

개별 생성자에 대해서 `AutoFactory`를 선언하여 타입에 선언된 어트리뷰트의 설정을 변경할 수 있습니다.

```csharp
using Macaron.FactoryMethod;

[AutoFactory("Create")]
public partial class Foo
{
    public Foo(int bar) { }

    [AutoFactory("Of")]
    public Foo(int bar, string baz) { }
}
```

위 코드는 아래와 같은 코드를 생성합니다.

```csharp
// <auto-generated />
#nullable enable

partial class Foo
{
    public static Foo Create(int bar) => new(bar);

    public static Foo Of(int bar, string baz) => new(bar, baz);
}
```

## 라이선스

이 프로젝트는 [Unlicense](LICENSE) 하에 배포됩니다.
